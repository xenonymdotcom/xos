/* Linker script for kernel */

/* Define the kernel entry point. Needed to prevent ld's -gc-sections option
 * getting rid of everything
 */
ENTRY(_start)

/* Define the memory as starting at 0x8000, and being a megabyte long
 * (shouldn't need to be more than this)
 */

MEMORY
{
	kernel : org = 0x8000, len = 1M
}

/* Output kernel code (.text) and data (.bss) into kernel address space
 *
 * Make sure start.o comes first, so the entry point is at the start of the
 * file
 *
 * Puts .bss in the middle to force the final binary kernel to contain it;
 * this means it will be set to 0 rather than left to whatever is in the
 * memory beforehand. This isn't very efficient.
 */

SECTIONS
{
	.text : 
	{ 
		start.o (.text) 
		* (.text*) 
	} >kernel
	
	.init_array : 
	{
    _init_array_start = .;
		KEEP(*(.init_array))
	    KEEP(*(.init_array*))
    _init_array_end = .;
	} > kernel
	
	.ro : 
	{ 
	    *(.ro*) 
	} >kernel
	
	.arm : { *(.ARM.exidx*) } >kernel
	
	.attrs : { *(.ARM.attributes) } >kernel
	
	.bss : 
	{ 
    _bss_start = .;
		*(.bss*) 
    _bss_end = .;
	} >kernel
	
	.data : { *(.data*) } >kernel
	
	.heap_start :
	{
	    _heap_start = .;
	} > kernel
}
